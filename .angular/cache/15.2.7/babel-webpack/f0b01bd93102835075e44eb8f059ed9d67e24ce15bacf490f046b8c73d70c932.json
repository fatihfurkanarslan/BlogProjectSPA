{"ast":null,"code":"import _defineProperty from \"C:/Users/Fatih Furkan Arslan/Desktop/Github/BlogProject-SPA/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { NoteService } from './../../services/note.service';\nimport { CommentService } from './../../services/comment.service';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { FormGroup, FormControl } from '@angular/forms';\nimport { TagService } from 'src/app/services/tag.service';\nimport { LikeService } from 'src/app/services/like.service';\nimport { Like } from './../../models/like';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { HttpClient } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"./../../services/note.service\";\nimport * as i3 from \"./../../services/comment.service\";\nimport * as i4 from \"src/app/services/auth.service\";\nimport * as i5 from \"src/app/services/tag.service\";\nimport * as i6 from \"src/app/services/like.service\";\nimport * as i7 from \"@angular/platform-browser\";\nimport * as i8 from \"@angular/common/http\";\nfunction NotePageComponent_ng_container_8_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵelement(1, \"div\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const b_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate(\"innerHTML\", b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.text, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction NotePageComponent_ng_container_8_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 24);\n  }\n  if (rf & 2) {\n    const b_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate(\"innerHTML\", \"<h\" + (b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.level) + \" class=ce-header\" + \">\" + (b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.text) + \"</h\" + (b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.level) + \">\", i0.ɵɵsanitizeHtml);\n  }\n}\nfunction NotePageComponent_ng_container_8_div_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 27);\n    i0.ɵɵelementContainerStart(2);\n    i0.ɵɵelement(3, \"img\", 28)(4, \"div\", 29);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const b_r4 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.file == null ? null : b_r4.data.file.url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"innerHTML\", b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.caption, i0.ɵɵsanitizeHtml);\n  }\n}\nfunction NotePageComponent_ng_container_8_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, NotePageComponent_ng_container_8_div_5_div_1_Template, 5, 2, \"div\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const b_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", b_r4 == null ? null : b_r4.data == null ? null : b_r4.data.file == null ? null : b_r4.data.file.url);\n  }\n}\nfunction NotePageComponent_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0, 16);\n    i0.ɵɵelementStart(1, \"div\", 17)(2, \"div\", 18);\n    i0.ɵɵtemplate(3, NotePageComponent_ng_container_8_div_3_Template, 2, 1, \"div\", 19);\n    i0.ɵɵtemplate(4, NotePageComponent_ng_container_8_div_4_Template, 1, 1, \"div\", 20);\n    i0.ɵɵtemplate(5, NotePageComponent_ng_container_8_div_5_Template, 2, 1, \"div\", 21);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const b_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngSwitch\", b_r4 == null ? null : b_r4.type);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"paragraph\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"header\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"image\");\n  }\n}\nfunction NotePageComponent_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function NotePageComponent_button_18_Template_button_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const tag_r14 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.searchNotes(tag_r14.tags));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const tag_r14 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", tag_r14 == null ? null : tag_r14.tags, \" \");\n  }\n}\nfunction NotePageComponent_span_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\")(1, \"mat-card\", 31)(2, \"mat-card-header\");\n    i0.ɵɵelement(3, \"div\", 32);\n    i0.ɵɵelementStart(4, \"mat-card-title\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"mat-card-subtitle\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 33)(10, \"div\", 34)(11, \"mat-card-content\")(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"div\", 35)(15, \"button\", 36);\n    i0.ɵɵlistener(\"click\", function NotePageComponent_span_24_Template_button_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const comment_r17 = restoredCtx.$implicit;\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.deleteComment(comment_r17.id));\n    });\n    i0.ɵɵelementStart(16, \"mat-icon\");\n    i0.ɵɵtext(17, \"delete\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelement(18, \"br\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const comment_r17 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.authService.decodedToken == null ? null : ctx_r2.authService.decodedToken.unique_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 3, comment_r17.onCreated, \"mediumDate\"));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", comment_r17.text, \" \");\n  }\n}\nfunction NotePageComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 37)(1, \"form\", 38);\n    i0.ɵɵlistener(\"ngSubmit\", function NotePageComponent_div_25_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.makeComment());\n    });\n    i0.ɵɵelementStart(2, \"mat-form-field\", 39)(3, \"input\", 40);\n    i0.ɵɵlistener(\"ngModelChange\", function NotePageComponent_div_25_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.commentModel.text = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementStart(5, \"button\", 41);\n    i0.ɵɵtext(6, \"Publish \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.form);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.commentModel.text);\n  }\n}\nconst _c0 = function () {\n  return [\"facebook\", \"email\", \"linkedin\", \"pinterest\", \"twitter\", \"whatsapp\"];\n};\nexport let NotePageComponent = /*#__PURE__*/(() => {\n  class NotePageComponent {\n    constructor(route, noteService, commentService, authService, router, tagService, likeService, domSanitizer, httpClient) {\n      _defineProperty(this, \"route\", void 0);\n      _defineProperty(this, \"noteService\", void 0);\n      _defineProperty(this, \"commentService\", void 0);\n      _defineProperty(this, \"authService\", void 0);\n      _defineProperty(this, \"router\", void 0);\n      _defineProperty(this, \"tagService\", void 0);\n      _defineProperty(this, \"likeService\", void 0);\n      _defineProperty(this, \"domSanitizer\", void 0);\n      _defineProperty(this, \"httpClient\", void 0);\n      _defineProperty(this, \"commentModel\", {});\n      _defineProperty(this, \"likeModel\", {});\n      _defineProperty(this, \"id\", void 0);\n      _defineProperty(this, \"userId\", void 0);\n      _defineProperty(this, \"form\", new FormGroup({\n        Text: new FormControl('')\n      }));\n      _defineProperty(this, \"sub\", void 0);\n      _defineProperty(this, \"note\", void 0);\n      _defineProperty(this, \"commentsArray\", void 0);\n      _defineProperty(this, \"likes\", void 0);\n      _defineProperty(this, \"likeCount\", 0);\n      _defineProperty(this, \"commentToInsert\", void 0);\n      _defineProperty(this, \"tags\", void 0);\n      _defineProperty(this, \"htmlCode\", void 0);\n      _defineProperty(this, \"toBeParsedData\", void 0);\n      _defineProperty(this, \"token\", void 0);\n      this.route = route;\n      this.noteService = noteService;\n      this.commentService = commentService;\n      this.authService = authService;\n      this.router = router;\n      this.tagService = tagService;\n      this.likeService = likeService;\n      this.domSanitizer = domSanitizer;\n      this.httpClient = httpClient;\n      this.token = null;\n    }\n    ngOnInit() {\n      this.token = localStorage.getItem('token');\n      this.sub = this.route.params.subscribe(params => {\n        this.id = +params['id'];\n      });\n      this.noteService.getNote(this.id).subscribe(data => {\n        this.note = data;\n        this.toBeParsedData = JSON.parse(this.note.rawText);\n        //this.htmlCode = this.domSanitizer.bypassSecurityTrustHtml(this.note.text);\n      }, error => console.log('failed note get method'));\n      // this.tagService.getTags(this.id).subscribe(result => {this.tags = result; },\n      //   error => {\n      // console.log('tag service failed ');\n      //   });\n      this.commentService.getComments(+this.id).subscribe(commentList => {\n        console.log(\"in comment service\");\n        this.commentsArray = commentList;\n      }, error => {\n        console.log('comment service failed');\n      });\n    }\n    onSubmit() {\n      this.commentService.updateComment(this.commentToInsert).subscribe(result => {\n        console.log('successed');\n      }, error => console.log('failed'));\n    }\n    makeComment() {\n      this.userId = this.authService.decodedToken.nameid;\n      this.httpClient.get(\"http://api.ipify.org/?format=json\").subscribe(res => {\n        this.commentModel.IPAddress = \"\" + res.ip;\n        console.log(\"idadress : \" + this.commentModel.IPAddress);\n        this.commentModel.userId = this.userId;\n        this.commentModel.noteId = this.note.id;\n        this.commentService.insertComment(this.commentModel).subscribe(result => {\n          console.log('success to insert comment :' + result);\n          this.noteService.getNote(+this.id).subscribe(data => {\n            this.note = data;\n          }, error => console.log('failed note get method'));\n          this.commentModel.text = '';\n        }, error => {\n          console.log('failed to insert comment :' + error);\n        });\n      });\n    }\n    searchNotes(btnValue) {\n      this.router.navigateByUrl('/searchednotes', {\n        state: {\n          redirect: btnValue\n        }\n      });\n    }\n    increaseLike() {\n      if (this.likeCount < 10) {\n        this.likeModel.userId = this.userId;\n        this.likeModel.noteId = this.note.id;\n        this.likeService.insertLike(this.likeModel).subscribe(result => {});\n        this.note.likes.push(new Like());\n        this.likeCount++;\n      } else {\n        console.log('limit of like button');\n      }\n    }\n    deleteComment(commentId) {\n      this.commentService.deleteComment(commentId).subscribe(result => {\n        console.log('comment id ' + commentId);\n        this.commentService.getComments(+this.id).subscribe(commentList => {\n          console.log(\"in comment service in deletecomment func\");\n          this.commentsArray = commentList;\n        }, error => {\n          console.log('comment service failed');\n        });\n      });\n    }\n  }\n  _defineProperty(NotePageComponent, \"\\u0275fac\", function NotePageComponent_Factory(t) {\n    return new (t || NotePageComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.NoteService), i0.ɵɵdirectiveInject(i3.CommentService), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i5.TagService), i0.ɵɵdirectiveInject(i6.LikeService), i0.ɵɵdirectiveInject(i7.DomSanitizer), i0.ɵɵdirectiveInject(i8.HttpClient));\n  });\n  _defineProperty(NotePageComponent, \"\\u0275cmp\", /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: NotePageComponent,\n    selectors: [[\"app-note-page\"]],\n    decls: 26,\n    vars: 12,\n    consts: [[1, \"note\"], [2, \"font-size\", \"30px\"], [1, \"ce-block\"], [1, \"ce-block__content\"], [3, \"ngSwitch\", 4, \"ngFor\", \"ngForOf\"], [1, \"parent-element\"], [\"mat-fab\", \"\", 2, \"background-color\", \"white\", 3, \"click\"], [2, \"color\", \"#1F4E5F\"], [2, \"margin-left\", \"20px\"], [1, \"container\"], [1, \"tag\"], [\"class\", \"tagbutton\", \"style\", \"margin:5px;\", \"aria-label\", \"Show an example snack-bar\", \"mat-stroked-button\", \"\", \"color\", \"primary\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"container-fluid\"], [\"theme\", \"material-dark\", \"url\", \"http://www.google.com\", \"description\", \"Angular Share Buttons\", \"twitterAccount\", \"aaa\", 1, \"pt-5\", 3, \"include\", \"showIcon\", \"showText\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"commentform\", 4, \"ngIf\"], [3, \"ngSwitch\"], [\"fxLayout\", \"row\", \"fxLayoutGap\", \"5px\", \"fxLayoutAlign\", \"start center\"], [\"fxFlex\", \"92\"], [3, \"innerHTML\", 4, \"ngSwitchCase\"], [\"style\", \"height: fit-content;\", 3, \"innerHTML\", 4, \"ngSwitchCase\"], [4, \"ngSwitchCase\"], [3, \"innerHTML\"], [1, \"ce-paragraph\", \"cdx-block\"], [2, \"height\", \"fit-content\", 3, \"innerHTML\"], [\"class\", \"cdx-block image-tool image-tool--filled\", 4, \"ngIf\"], [1, \"cdx-block\", \"image-tool\", \"image-tool--filled\"], [1, \"image-tool__image\"], [1, \"image-tool__image-picture\", 3, \"src\"], [2, \"text-align\", \"center\", \"margin-top\", \"5px\", 3, \"innerHTML\"], [\"aria-label\", \"Show an example snack-bar\", \"mat-stroked-button\", \"\", \"color\", \"primary\", 1, \"tagbutton\", 2, \"margin\", \"5px\", 3, \"click\"], [1, \"example-card\"], [\"mat-card-avatar\", \"\", 1, \"example-header-image\"], [1, \"row\"], [1, \"col-md-10\"], [1, \"col-md-2\"], [\"mat-icon-button\", \"\", 3, \"click\"], [1, \"commentform\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"example-full-width\"], [\"matInput\", \"\", \"formControlName\", \"Text\", \"required\", \"\", \"placeholder\", \"Write A Comment\", \"name\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"aria-label\", \"Show an example snack-bar\", \"mat-raised-button\", \"\"]],\n    template: function NotePageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"span\", 1)(2, \"b\");\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(4, \"br\")(5, \"br\");\n        i0.ɵɵelementStart(6, \"div\", 2)(7, \"div\", 3);\n        i0.ɵɵtemplate(8, NotePageComponent_ng_container_8_Template, 6, 4, \"ng-container\", 4);\n        i0.ɵɵpipe(9, \"arrayFix\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(10, \"div\", 5)(11, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function NotePageComponent_Template_button_click_11_listener() {\n          return ctx.increaseLike();\n        });\n        i0.ɵɵelementStart(12, \"mat-icon\", 7);\n        i0.ɵɵtext(13, \"favorite\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"mat-label\", 8);\n        i0.ɵɵtext(15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 9)(17, \"mat-label\", 10);\n        i0.ɵɵtemplate(18, NotePageComponent_button_18_Template, 2, 1, \"button\", 11);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(19, \"div\", 12);\n        i0.ɵɵelement(20, \"share-buttons\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(21, \"br\")(22, \"br\")(23, \"br\");\n        i0.ɵɵtemplate(24, NotePageComponent_span_24_Template, 19, 6, \"span\", 14);\n        i0.ɵɵtemplate(25, NotePageComponent_div_25_Template, 7, 2, \"div\", 15);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.note == null ? null : ctx.note.title);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(9, 9, ctx.toBeParsedData == null ? null : ctx.toBeParsedData.blocks));\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate1(\" \", ctx.note == null ? null : ctx.note.likes == null ? null : ctx.note.likes.length, \" glories\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.tags);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"include\", i0.ɵɵpureFunction0(11, _c0))(\"showIcon\", true)(\"showText\", true);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.commentsArray);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.token);\n      }\n    },\n    styles: [\".note,.example-card{margin-left:15%;margin-right:15%}.example-header-image{background-image:url(http://www.iconninja.com/files/1024/108/58/users-human-avatar-people-male-account-person-user-man-profile-icon.png);background-size:cover}.material-icons.md-18{font-size:18px}.material-icons.md-24{font-size:24px}.material-icons.md-36{font-size:36px}.material-icons.md-48{font-size:48px}.material-icons.md-dark{color:#0000008a}.material-icons.md-dark.md-inactive{color:#00000042}.material-icons.md-light{color:#fff}.material-icons.md-light.md-inactive{color:#ffffff4d}.parent-element{display:flex;align-items:center}.sharebuttons{position:absolute;right:25%}.tagbutton{margin-right:8px}.commentform{text-align:center}.example-full-width{width:80%;flex-direction:column}\\n\"],\n    encapsulation: 2\n  }));\n  return NotePageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}