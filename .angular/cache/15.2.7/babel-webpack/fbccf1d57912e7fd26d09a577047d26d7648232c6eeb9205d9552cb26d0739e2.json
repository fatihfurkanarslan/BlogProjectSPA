{"ast":null,"code":"import _defineProperty from \"C:/Users/Fatih Furkan Arslan/Desktop/Github/BlogProject-SPA/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { ProfileService } from './../../services/profile.service';\nimport { User } from './../../models/user';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { PhotobarComponent } from 'src/app/photobar/photobar.component';\nimport { PhotoService } from './../../services/photo.service';\nimport axios from 'axios';\nimport { ErrorphotobarComponent } from 'src/app/errorphotobar/errorphotobar.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../../services/profile.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"src/app/services/auth.service\";\nimport * as i4 from \"./../../services/photo.service\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/card\";\nexport let EditprofileComponent = /*#__PURE__*/(() => {\n  class EditprofileComponent {\n    constructor(profileService, _snackBar, authService, photoService) {\n      _defineProperty(this, \"profileService\", void 0);\n      _defineProperty(this, \"_snackBar\", void 0);\n      _defineProperty(this, \"authService\", void 0);\n      _defineProperty(this, \"photoService\", void 0);\n      _defineProperty(this, \"user\", void 0);\n      _defineProperty(this, \"userId\", void 0);\n      _defineProperty(this, \"selectedFile\", null);\n      _defineProperty(this, \"durationInSeconds\", 3);\n      _defineProperty(this, \"data\", new FormData());\n      _defineProperty(this, \"photoUrl\", void 0);\n      this.profileService = profileService;\n      this._snackBar = _snackBar;\n      this.authService = authService;\n      this.photoService = photoService;\n      this.user = new User();\n      this.profileService.getChangeInPhoto.subscribe(photoUrl => this.changePhoto(photoUrl));\n    }\n    changePhoto(_photoUrl) {\n      this.photoUrl = _photoUrl;\n    }\n    ngOnInit() {\n      // tslint:disable-next-line:prefer-const\n      // let userId = localStorage.getItem('editUserId');\n      this.userId = this.authService.decodedToken.nameid;\n      this.profileService.getUser(this.userId).subscribe(result => {\n        this.user = result;\n      });\n    }\n    onFileSelected(event) {\n      this.selectedFile = event.target.files[0];\n      // console.log(this.selectedFile);\n      this.data.append('File', this.selectedFile);\n      axios.post('https://localhost:44369/api/photo/insertphotonote', this.data, {\n        headers: {\n          'accept': 'application/json',\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(res => {\n        this.photoUrl = res.data;\n        this.user.photoUrl = this.photoUrl;\n        console.log(\"PhotoUrl : \" + this.photoUrl);\n        this.openSnackBar();\n      }).catch(err => {\n        this.errorPhotoBar();\n      });\n      // this.photoService.insertPhoto(this.data).subscribe(result => {\n      //   this.photoUrl = result;\n      //   console.log('ffjslk   ' + this.photoUrl);\n      // }, error => {\n      //   console.log('photo yukleme basarısız');\n      // });\n    }\n\n    updateProfile() {\n      console.log('in editprofile in updateprofil method' + this.user.photoUrl);\n      this.profileService.updateUser(this.user).subscribe(result => {\n        console.log('basarılı edit user');\n      }, error => {\n        console.log('failed at edit user');\n      });\n    }\n    openSnackBar() {\n      this._snackBar.openFromComponent(PhotobarComponent, {\n        duration: this.durationInSeconds * 1000,\n        verticalPosition: 'top'\n      });\n      this.user.photoUrl = this.photoUrl;\n    }\n    errorPhotoBar() {\n      this._snackBar.openFromComponent(ErrorphotobarComponent, {\n        duration: this.durationInSeconds * 1000,\n        verticalPosition: 'top'\n      });\n    }\n  }\n  _defineProperty(EditprofileComponent, \"\\u0275fac\", function EditprofileComponent_Factory(t) {\n    return new (t || EditprofileComponent)(i0.ɵɵdirectiveInject(i1.ProfileService), i0.ɵɵdirectiveInject(i2.MatSnackBar), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.PhotoService));\n  });\n  _defineProperty(EditprofileComponent, \"\\u0275cmp\", /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditprofileComponent,\n    selectors: [[\"app-editprofile\"]],\n    decls: 25,\n    vars: 5,\n    consts: [[1, \"example-card\"], [1, \"center\"], [1, \"example-full-width\"], [\"matInput\", \"\", \"placeholder\", \"username\", \"maxlength\", \"20\", \"name\", \"username\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"firstname\", \"maxlength\", \"20\", \"name\", \"firstname\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"lastname\", \"maxlength\", \"20\", \"name\", \"lastname\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"description\", \"maxlength\", \"80\", \"name\", \"description\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-card-image\", \"\", \"alt\", \"Photo of a Shiba Inu\", 3, \"src\"], [1, \"centerphoto\"], [\"mat-raised-button\", \"\", 1, \"button\", 3, \"click\"], [1, \"material-icons\"], [\"type\", \"file\", 2, \"display\", \"none\", 3, \"change\"], [\"fileInput\", \"\"], [\"mat-button\", \"\", 2, \"margin\", \"auto\", 3, \"click\"]],\n    template: function EditprofileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r1 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"mat-card\", 0)(1, \"span\", 1);\n        i0.ɵɵtext(2, \"Edit Profile\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"mat-form-field\", 2)(4, \"input\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function EditprofileComponent_Template_input_ngModelChange_4_listener($event) {\n          return ctx.user.username = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"mat-form-field\", 2)(6, \"input\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function EditprofileComponent_Template_input_ngModelChange_6_listener($event) {\n          return ctx.user.firstname = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"mat-form-field\", 2)(8, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function EditprofileComponent_Template_input_ngModelChange_8_listener($event) {\n          return ctx.user.lastname = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"mat-form-field\", 2)(10, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function EditprofileComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.user.description = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(11, \"br\")(12, \"img\", 7)(13, \"br\");\n        i0.ɵɵelementStart(14, \"div\", 8)(15, \"button\", 9);\n        i0.ɵɵlistener(\"click\", function EditprofileComponent_Template_button_click_15_listener() {\n          i0.ɵɵrestoreView(_r1);\n          const _r0 = i0.ɵɵreference(21);\n          return i0.ɵɵresetView(_r0.click());\n        });\n        i0.ɵɵelementStart(16, \"i\", 10);\n        i0.ɵɵtext(17, \"add\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"span\");\n        i0.ɵɵtext(19, \"Select A Photo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"input\", 11, 12);\n        i0.ɵɵlistener(\"change\", function EditprofileComponent_Template_input_change_20_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(22, \"mat-card-actions\")(23, \"button\", 13);\n        i0.ɵɵlistener(\"click\", function EditprofileComponent_Template_button_click_23_listener() {\n          return ctx.updateProfile();\n        });\n        i0.ɵɵtext(24, \"Save Changes\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.user.username);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.user.firstname);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.user.lastname);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.user.description);\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate(\"src\", ctx.user == null ? null : ctx.user.photoUrl, i0.ɵɵsanitizeUrl);\n      }\n    },\n    dependencies: [i5.DefaultValueAccessor, i5.NgControlStatus, i5.MaxLengthValidator, i5.NgModel, i6.MatButton, i7.MatFormField, i8.MatInput, i9.MatCard, i9.MatCardActions, i9.MatCardImage],\n    styles: [\".example-full-width[_ngcontent-%COMP%]{width:100%}.example-card[_ngcontent-%COMP%]{max-width:40%;text-align:center;margin:auto}\"]\n  }));\n  return EditprofileComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}